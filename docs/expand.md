# Expand Development

## Custom development extension

`smart-doc` makes a data open interface for the data after scanning and analysis, and opens two types of api data structures, 
one is tiled and can be directly rendered, and the other api parameter relationship is quasi changed to a tree structure The way. 
You can choose to use different data interfaces according to your needs.

Development case：
1. For example, after the data is obtained using the open interface of smart-doc, the development tool generates a jemeter performance test script.
2. After obtaining the data of the api interface document, the development tool generates an automated test script.
3. Development tools import smart-doc data into some api document management systems.( **ps:Don't expect too much from smart-doc to connect with the open source document management system on the market, because no one has become an industry technical standard and we can be tempted to support it.** )

Development and integration recommendation: For students who use the open data of smart-doc to develop tools, it is recommended to build a separate tool project and enter smart-doc as an open source component. If you modify it after fork, it is difficult to follow the official upgrade of smart-doc, the underlying component.
### Document data acquisition
Since version 1.7.0, smart-doc has opened the api interface related information data generated after scanning the source code, that is, smart-doc is currently used to render the data of markdown, html and other format documents. The operation of obtaining data is very simple. If you own a team If you have the ability to develop your own document management system, then the interface document data you get from smart-doc will be stored in your own document management system, and smart-doc will automatically do it for the name of each Controller and the name of each interface method. The md5 signature basically guarantees the uniqueness. You can directly structure the document data and store it in the document management system for management and display.

```java
/**
    * Including setting request headers, fields with missing comments are used in batches with defined comments during document generation
    */
@Test
public void testBuilderControllersApi() {
    // Please refer to other examples for config configuration information
    ApiConfig config = new ApiConfig();
    
    // After version 1.7.9, it is used as follows. This interface is used to obtain flat parameter list data. If you want to render other documents by yourself, you can use this data to render directly.
    ApiAllData apiAllData = ApiDataBuilder.getApiData(config);
    // It has been added since version 1.9.2. The data acquired by this interface is converted from the parameter list into a tree interface. When docking with other document management, data can be obtained from this interface for easy processing.
    ApiAllData docList = ApiDataBuilder.getApiDataTree(config);
    
}
```
The field information is as follows：

Field | Type|Description|Since
---|---|---|---
projectName|string|Project name|-
projectId|string|Project id, name is generated by md5|-
language|string|Documentation language (customized templates can be used)|-
apiDocList|array|interface document list|-
└─order|int32|controller order, smart-doc automatic sorting generation|1.7+
└─name|string|controller class name|-
└─alias|string|The controller name is the alias after md5|1.7+
└─list|array|interface list in controller|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─methodId|method id, use controller+method to do md5 take 32 bits|1.7.3 +
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─name|string|method name|1.7.3 +
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─order|int32|Interface serial number, automatic ordering|1.7+
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─desc|string|method description|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─detail|string|detailed introduction of the method|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─url|string|controller method url|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─author|string|interface author name|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─type|string|http request type|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─headers|string|string type header splicing, just to reduce the number of header rendering times in template rendering|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─contentType|string|http contentType|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─requestHeaders|array|http request headers|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─name|string|Request header name|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─type|string|Request header type|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─desc|string|Request header description|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─required|boolean|required flag|1.7.0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─since|string|Starting version number|1.7.0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─requestParams|array|http request params|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─field|string|field|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─type|string|field type|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─desc|string|description|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─required|boolean|require flag|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─version|string|version|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─requestUsage|string|http request usage|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─responseUsage|string|http response usage|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─responseParams|array|http response params|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─field|string|field|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─type|string|field type|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─desc|string|description|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─required|boolean|require flag|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─version|string|version|-
└─desc|string|method description|-
apiDocDictList|array|Enumerated dictionary list|-
└─order|int32|Dictionary order|-
└─title|string|Dictionary name|-
└─dataDictList|array|Enumerated dictionary table|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─value|string|Dictionary code|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─type|string|Dictionary value type|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─desc|string|Dictionary description|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─ordinal|int32|enumeration order|-
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─name|string|enumeration order|-
errorCodeList|array|enumeration error list|-
└─value|string|error code|-
└─type|string|error code type|-
└─desc|string|error code description|-
└─ordinal|int32|The order of enumerating error codes|-
└─name|string|enumeration name|-
revisionLogs|array|document change records|-
└─version|string|version|-
└─status|string|status|-
└─author|string|author|-
└─revisionTime|string|update time|-
└─remarks|string|description|-

**Note:** The data acquisition interface has changed after 1.7.9. If you need to render the template yourself, the final data is the most important. `ApiDataBuilder`.


 ## Other framework documents


smart-doc currently supports analysis at the Spring technology stack web and Apache Dubbo level. Since the official open source manpower is limited, it is unable to satisfy the analysis of other web layer frameworks.
Of course, a web-level framework is required. Generally, the framework needs to meet the following conditions:
- The framework uses clear annotation routing (in layman's terms, a Spring-like Controller has a clear annotation to declare the path path), or it can be an implementation framework similar to the Jakarta RS-API 2.x specification.

Let's look at the implementation support writing.

### Write the framework of the document construction analysis implementation template
Take the current Java cloud native framework `Quarkus` as an example. If you support `Quarkus` on smart-doc. Then first create a new `QuarkusDocBuildTemplate` under the `com.power.doc.template` package of smart-doc, and `QuarkusDocBuildTemplate` implements the `IDocBuildTemplate` interface. code show as below:

```java
/**
 * @author yu 2021/6/28.
 */
public class QuarkusDocBuildTemplate implements IDocBuildTemplate<ApiDoc>{

    /**
     * Generate document data for the entire project
     * @param projectBuilder
     * @return
     */
    @Override
    public List<ApiDoc> getApiData(ProjectDocConfigBuilder projectBuilder) {
        return null;
    }

    /**
     * Generate documentation for a single interface class (implementation is not required, not officially supported)
     * @param projectBuilder
     * @param apiClassName
     * @return
     */
    @Override
    public ApiDoc getSingleApiData(ProjectDocConfigBuilder projectBuilder, String apiClassName) {
        return null;
    }

    @Override
    public boolean ignoreReturnObject(String typeName, List<String> ignoreParams) {
        return false;
    }
}
```
Then combine the use of Quarkus and refer to the current SpringBootDocBuildTemplate implementation to complete the implementation of the QuarkusDocBuildTemplate generated interface data.

### Modify the framework to support enumeration
Modify FrameworkEnum in com.power.doc.constants and add Quarkus.

```java
/**
 * Smart-doc Supported Framework
 *
 * @author yu 2021/6/27.
 */
public enum FrameworkEnum {

    /**
     * Apache Dubbo
     */
    DUBBO("dubbo", "com.power.doc.template.RpcDocBuildTemplate"),

    /**
     * Spring Framework
     */
    SPRING("spring", "com.power.doc.template.SpringBootDocBuildTemplate"),

    /**
     * Quarkus Framework
     */
    QUARKUS("quarkus","com.power.doc.template.QuarkusDocBuildTemplate");

    // Omit multiple lines

}
```

### Use the newly added framework to resolve
Then configure the framework name you use when using smart-doc in your project. Smart-doc defaults to spring, so the newly added framework needs to be specified in the configuration when using it.

```json
{
  "serverUrl": "http://127.0.0.1",
  "isStrict": false,
  "allInOne": true,
  "outPath": "D://md2",
  "framework": "quarkus"
}
```
This is the development process, the main difficulty lies in the implementation of IDocBuildTemplate.


